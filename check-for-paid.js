const Path = require('path');
const Fs = require('fs');
const { execute, csvToArray } = require('./utils');
const log_storage_path = Path.join(__dirname, 'logs-storage');
const all_time_log_path = Path.join(log_storage_path, 'all-time.log');
require('dotenv').config();
const pnm_report_filepath = process.env.PNM_REPORT_FILEPATH ?? null;

let str_arr = [
	'4343405617943567',
	'4343405616244868',
	'4343405614534708',
	'4343405614132065',
	'4343405610030784',
	'4343405611853085',
	'4343405611386052',
	'4343405611860833',
	'4343405615367538',
	'4343405615671319',
	'4343405614703154',
	'4343405613672749',
	'4343405614039005',
	'4343405616159991',
	'4343405615775888',
	'4343405614135175',
	'4343405612846526',
	'4343405619211823',
	'4343405610128091',
	'434340561894',
	'4343405612017839',
	'4343405616614383',
	'434340561849',
	'4343405617649016',
	'4343405618286818',
	'4343405617634620',
	'4343405614739851',
	'4343405616677679',
	'4343405615617098',
	'4343405617186902',
	'4343405618739311',
	'4343405615374443',
	'4343405617526552',
	'4343405618282759',
	'4343405618017924',
	'4343405613758340',
	'4343405611632208',
	'4343405613319432',
	'4343405618756851',
	'4343405612818590',
	'4343405613507051',
	'4343405619203770',
	'4343405614532611',
	'4343405614475324',
	'4343405612225903',
	'4343405613562924',
	'4343405613441640',
	'4343405619856601',
	'4343405610663402',
	'4343405619642019',
	'434340561566',
	'4343405615328589',
	'4343405614361995',
	'4343405618564768',
	'4343405613619088',
	'4343405617941959',
	'4343405610685983',
	'4343405610914839',
	'4343405614659166',
	'4343405616742648',
	'4343405612555184',
	'4343405615259412',
	'4343405617066542',
	'4343405615804530',
	'4343405619529679',
	'4343405611276485',
	'4343405614000544',
	'4343405613593895',
	'4343405611120105',
	'4343405616191200',
	'4343405614016813',
	'4343405617214548',
	'4343405611550459',
	'4343405615406922',
	'4343405612854074',
	'4343405613962520',
	'434340561444',
	'4343405612630607',
	'4343405617583744',
	'4343405615095246',
	'4343405612143064',
	'4343405611876631',
	'4343405612169424',
	'4343405612348317',
	'4343405611003202',
	'4343405616409016',
	'4343405617963326',
	'4343405615542460',
	'4343405617177067',
	'4343405611327635',
	'4343405614074416',
	'4343405619141780',
	'4343405614937182',
	'4343405617286652',
	'4343405619291817',
	'4343405612709799',
	'4343405618591043',
	'4343405615665733',
	'4343405619832016',
	'4343405613971653',
	'4343405612624519',
	'4343405618513203',
	'4343405615110482',
	'4343405617672927',
	'4343405614898350',
	'4343405617097554',
	'4343405617186092',
	'4343405613652592',
	'4343405616218722',
	'4343405611033878',
	'4343405615354627',
	'4343405613784403',
	'4343405617922207',
	'4343405616678024',
	'4343405614550365',
	'4343405619452740',
	'4343405614592516',
	'4343405618175334',
	'4343405619722506',
	'4343405616086806',
	'4343405610261843',
	'4343405611915413',
	'4343405614961588',
	'4343405616780887',
	'4343405612333871',
	'4343405615373015',
	'4343405610873472',
	'4343405619154502',
	'4343405611025577',
	'4343405615008447',
	'4343405612725852',
	'4343405616147194',
	'4343405614935012',
	'4343405619141970',
	'4343405615465233',
	'4343405612292135',
	'434340561848',
	'4343405612937713',
	'4343405615082962',
	'4343405618034804',
	'4343405618344583',
	'4343405618290240',
	'4343405618668791',
	'4343405610035981',
	'4343405612568153',
	'4343405619383440',
	'4343405617954226',
	'434340561847',
	'434340561454',
	'4343405612236124',
	'4343405617022727',
	'4343405612941236',
	'4343405611388215',
	'4343405617488050',
	'4343405610298456',
	'4343405619480725',
	'4343405617784854',
	'4343405618707995',
	'4343405616120464',
	'434340561652',
	'4343405615795373',
	'4343405614134004',
	'4343405611827725',
	'4343405613217586',
	'4343405613138253',
	'4343405618035215',
	'4343405615689022',
	'4343405615026357',
	'4343405615834081',
	'4343405619681884',
	'4343405618598048',
	'4343405614396868',
	'4343405615631776',
	'4343405616844493',
	'4343405619336042',
	'4343405614798154',
	'4343405610069402',
	'4343405610448960',
	'4343405618153752',
	'4343405615644100',
	'4343405616367198',
	'4343405612195437',
	'4343405618219967',
	'4343405618498736',
	'434340561644',
	'4343405616438577',
	'4343405613827004',
	'4343405616068648',
	'4343405611015081',
	'434340561726',
	'4343405618077142',
	'4343405611091504',
	'4343405612029933',
	'4343405618872948',
	'4343405610261124',
	'4343405618263288',
	'4343405616714480',
	'434340561824',
	'4343405612973981',
	'4343405617528087',
	'4343405613972966',
	'434340561837',
	'4343405611697094',
	'4343405610904723',
	'4343405611944256',
	'4343405616100797',
	'4343405611454009',
	'4343405611650978',
	'4343405613203792',
	'4343405615906657',
	'4343405614948148',
	'4343405618924707',
	'4343405617559140',
	'4343405617220412',
	'4343405614621166',
	'4343405612753300',
	'4343405618491327',
	'4343405618219678',
	'4343405614299906',
	'4343405612964063',
	'4343405619339111',
	'4343405616868047',
	'4343405613986347',
	'4343405618081045',
	'4343405618442502',
	'4343405615106878',
	'4343405615096293',
	'4343405616055660',
	'4343405617807036',
	'4343405615222279',
	'4343405617692883',
	'4343405615190211',
	'434340561627',
	'4343405614628963',
	'4343405617784763',
	'4343405616532437',
	'4343405613025336',
	'4343405618001357',
	'4343405619573677',
	'4343405610741141',
	'4343405614906419',
	'43434056149295064',
	'4343405610645896',
	'4343405617867865',
	'4343405616205786',
	'4343405614330008',
	'4343405611657619',
	'434340561647',
	'4343405618419526',
	'4343405611910711',
	'4343405615908307',
	'4343405618972839',
	'43434056102295097',
	'4343405615195442',
	'434340561469',
	'4343405614904612',
	'434340561879',
	'4343405613968055',
	'4343405610770447',
	'4343405613952307',
	'4343405617713242',
	'4343405619528945',
	'4343405614969342',
	'4343405613260107',
	'4343405619979536',
	'4343405614167723',
	'4343405616312376',
	'4343405618458094',
	'4343405615161642',
	'4343405615880548',
	'4343405615633038',
	'4343405616803796',
	'4343405614777554',
	'4343405614652724',
	'4343405613613610',
	'4343405612676170',
	'4343405614297165',
	'4343405617597702',
	'4343405618817091',
	'4343405615293460',
	'4343405612355239',
	'4343405615535662',
	'4343405616180732',
	'4343405613229235',
	'4343405613440618',
	'4343405610017062',
	'4343405612401843',
	'4343405618537418',
	'4343405618700578',
	'4343405613191823',
	'4343405616700752',
	'4343405615303335',
	'4343405610564113',
	'4343405619111395',
	'4343405612623875',
	'4343405614451226',
	'4343405614493871',
	'4343405610313982',
	'4343405613121721',
	'4343405618319023',
	'4343405618181373',
	'4343405611154518',
	'4343405610573809',
	'4343405617513303',
	'4343405613894640',
	'4343405619903635',
	'4343405613068419',
	'4343405619483638',
	'434340561838',
	'4343405613535037',
	'4343405619718728',
	'4343405614725611',
	'4343405618669443',
	'4343405610503657',
	'4343405618310048',
	'4343405616246459',
	'4343405610567405',
	'434340561884',
	'4343405611831438',
	'4343405616347174',
	'4343405615044665',
	'4343405612606144',
	'4343405616081724',
	'43434056192895076',
	'434340561242',
	'434340561786',
	'434340561688',
	'434340561447',
	'43434056111495005',
	'434340561869',
	'43434056193295070',
	'434340561564',
	'434340561442',
	'434340561897',
	'43434056176447717',
	'434340561994',
	'434340561344',
	'43434056161295036',
	'4343405614852522',
	'4343405614424',
	'434340561927',
	'434340561539',
	'4343405618570930',
	'4343405612322262',
	'434340561887',
	'4343405611187575',
	'4343405610176140',
	'4343405619495806',
	'4343405616719562',
	'4343405616264288',
	'4343405611962159',
	'4343405613150829',
	'4343405614682002',
	'4343405617485429',
	'4343405615490165',
	'4343405619379554',
	'4343405613623130',
	'4343405618861487',
	'4343405615992905',
	'4343405611801209',
	'4343405610822198',
	'4343405612576172',
	'4343405614060373',
	'4343405615471975',
	'4343405614510880',
	'4343405612964154',
	'4343405610188020',
	'4343405616845714',
	'4343405619536005',
	'4343405613270940',
	'4343405616171285',
	'4343405612492743',
	'4343405613095644',
	'4343405614185659',
	'4343405615265575',
	'4343405610371949',
	'4343405611566976',
	'4343405610993445',
	'4343405612757004',
	'4343405612978568',
	'4343405612331545',
	'4343405618269558',
	'4343405613606721',
	'4343405613939924',
	'4343405610639626',
	'4343405617824080',
	'4343405615953501',
	'4343405619868390',
	'4343405612918002',
	'4343405617058705',
	'4343405612454149',
	'4343405611532838',
	'4343405618729189',
	'4343405618941578',
	'4343405612712835',
	'4343405617877005',
	'4343405613110815',
	'4343405612141167',
	'4343405615596201',
	'4343405612936723',
	'4343405617757918',
	'4343405617863542',
	'4343405611124248',
	'4343405611603860',
	'4343405611588731',
	'4343405617516660',
	'4343405616696406',
	'4343405617647218',
	'4343405617437230',
	'4343405614232279',
	'4343405616543608',
	'4343405610771890',
	'4343405613989028',
	'4343405611405779',
	'4343405615640975',
	'4343405614787207',
	'4343405615104113',
	'4343405616453535',
	'4343405615184073',
	'4343405619517070',
	'4343405614792215',
	'4343405612226042',
	'4343405610146374',
	'4343405618361454',
	'4343405615858288',
	'4343405611307751',
	'4343405616893730',
	'4343405616561329',
	'4343405616479860',
	'4343405619484156',
	'4343405618285075',
	'4343405619517294',
	'4343405612376730',
	'4343405618474042',
	'4343405614127974',
	'4343405611879528',
	'4343405618528862',
	'4343405616696349',
	'4343405617389738',
	'4343405611042390',
	'4343405611182253',
	'4343405615181194',
	'4343405614006988',
	'4343405619887911',
	'4343405613907970',
	'4343405616469291',
	'4343405615091963',
	'4343405615423141',
	'4343405610742024',
	'4343405614770633',
	'4343405614011509',
	'4343405614364890',
	'4343405610505298',
	'4343405612128024',
	'4343405618866791',
	'4343405614392313',
	'4343405619481061',
	'4343405612342393',
	'4343405610360223',
	'4343405611218370',
	'4343405611811281',
	'4343405612875442',
	'4343405619904518',
	'4343405615285664',
	'4343405619855348',
	'4343405618034820',
	'4343405617701288',
	'4343405617128821',
	'4343405610459892',
	'4343405618806870',
	'4343405619096711',
	'4343405613601896',
	'4343405612843408',
	'4343405618815749',
	'4343405619115552',
	'4343405617111330',
	'4343405615930830',
	'4343405619999989',
	'4343405612223775',
	'4343405610135195',
	'4343405617419113',
	'4343405614930526',
	'4343405610892118',
	'4343405618394026',
	'4343405613159671',
	'4343405613867190',
	'4343405612729987',
	'4343405610240433',
	'4343405611808840',
	'4343405611088831',
	'4343405616478714',
	'4343405613339505',
	'4343405618824410',
	'4343405618829450',
	'4343405611519421',
	'4343405610147026',
	'4343405612042720',
	'4343405617866289',
	'4343405615074167',
	'4343405615628830',
	'4343405618986482',
	'4343405618357122',
	'4343405618872278',
	'4343405619112732',
	'4343405612464015',
	'4343405610971920',
	'4343405612656487',
	'4343405619174401',
	'4343405613759256',
	'4343405618643976',
	'4343405610794645',
	'4343405614792777',
	'4343405610591942',
	'4343405618255086',
	'4343405612120906',
	'4343405612289495',
	'4343405614821741',
	'4343405617138390',
	'4343405613977015',
	'4343405610730714',
	'4343405611704411',
	'4343405614244126',
	'4343405619705048',
	'4343405611208157',
	'4343405611937334',
	'4343405610614397',
	'4343405615134656',
	'4343405617961262',
	'4343405614365863',
	'4343405617353411',
	'4343405610096488',
	'4343405618116130',
	'4343405616022181',
	'4343405611182626',
	'4343405617497457',
	'4343405619592982',
	'4343405614528767',
	'4343405614247939',
	'4343405614174281',
	'4343405618623903',
	'4343405617668628',
	'4343405618479710',
	'4343405615577425',
	'4343405617680102',
	'4343405612664234',
	'4343405614189982',
	'4343405616002290',
	'4343405610556333',
	'4343405617741623',
	'4343405616830179',
	'4343405617118822',
	'4343405615429619',
	'4343405619044893',
	'4343405617144034',
	'4343405614637493',
	'4343405611521096',
	'4343405615112702',
	'4343405610953209',
	'4343405613654721',
	'4343405611505156',
	'4343405613900066',
	'4343405615043451',
	'4343405611051839',
	'4343405615895967',
	'4343405611739292',
	'4343405614665148',
	'4343405616105382',
	'4343405612583632',
	'4343405617747992',
	'4343405612129303',
	'4343405610896382',
	'4343405618085517',
	'4343405615167409',
	'4343405619156929',
	'4343405613364495',
	'4343405611526277',
	'4343405618239833',
	'4343405615474854',
	'4343405614369998',
	'4343405613871911',
	'4343405612488998',
	'4343405614046067',
	'4343405619291106',
	'4343405617262505',
	'4343405618844699',
	'4343405619491193',
	'4343405619386542',
	'4343405619428575',
	'4343405617792790',
	'4343405613398501',
	'4343405611132696',
	'4343405617766406',
	'4343405616074513',
	'4343405614652591',
	'4343405612836048',
	'4343405618489552',
	'4343405616605209',
	'4343405619892135',
	'4343405612799089',
	'4343405614603248',
	'4343405619289563',
	'4343405615508461',
	'4343405612831486',
	'4343405611251025',
	'4343405611597252',
	'4343405612202498',
	'4343405612533934',
	'4343405613832392',
	'4343405610451733',
	'4343405618397185',
	'4343405616132642',
	'4343405612811819',
	'4343405614445343',
	'4343405614459443',
	'4343405615922209',
	'4343405617143713',
	'4343405615910642',
	'4343405612072008',
	'4343405610894874',
	'4343405613616076',
	'4343405612203231',
	'4343405617826622',
	'4343405619006785',
	'4343405619382194',
	'4343405613794816',
	'4343405611409789',
	'4343405618046618',
	'4343405611634428',
	'4343405613199784',
	'4343405612029735',
	'4343405613372860',
	'4343405614091196',
	'4343405611563262',
	'4343405617051932',
	'4343405614363124',
	'4343405613814861',
	'4343405610648213',
	'4343405616314075',
	'4343405619138943',
	'4343405611363754',
	'4343405616936612',
	'4343405616980370',
	'4343405618717218',
	'4343405617932008',
	'4343405614674702',
	'4343405613312239',
	'4343405611171132',
	'4343405616862495',
	'4343405610928722',
	'4343405610906413',
	'4343405618702384',
	'4343405616335930',
	'4343405617459200',
	'4343405613720639',
	'4343405611412973',
	'4343405614541109',
	'4343405613991115',
	'4343405610170341',
	'4343405617717441',
	'4343405614220233',
	'4343405616898457',
	'4343405614361656',
	'4343405610235458',
	'4343405610930355',
	'4343405612427541',
	'4343405613258168',
	'4343405619138430',
	'4343405615310611',
	'4343405610454356',
	'4343405618739287',
	'4343405616969910',
	'4343405617880363',
	'4343405610936642',
	'4343405614633401',
	'4343405616983929',
	'4343405619773988',
	'4343405610471103',
	'4343405619833170',
	'4343405619584203',
	'4343405618095573',
	'4343405615431532',
	'4343405615447629',
	'4343405610661323',
	'4343405611928200',
	'4343405611384800',
	'4343405611116780',
	'4343405615775144',
	'4343405610692419',
	'4343405614775921',
	'4343405613227940',
	'4343405617846091',
	'4343405615103636',
	'4343405611478651',
	'4343405611749929',
	'4343405613229425',
	'4343405611218867',
	'4343405614811890',
	'4343405612277482',
	'4343405614101193',
	'4343405613069565',
	'4343405611537183',
	'4343405612550458',
	'4343405618051055',
	'4343405613754240',
	'4343405615217295',
	'4343405617755383',
	'4343405617404628',
	'4343405611221788',
	'4343405615421533',
	'4343405619882763',
	'4343405612439942',
	'4343405615239984',
	'4343405618992621',
	'4343405611806448',
	'4343405615941803',
	'4343405617125793',
	'4343405619937716',
	'4343405611140517',
	'4343405615955936',
	'4343405617679039',
	'4343405614035748',
	'4343405616653399',
	'4343405610009416',
	'4343405614319951',
	'4343405611681213',
	'4343405611515601',
	'4343405619489825',
	'4343405619312035',
	'4343405612294628',
	'4343405613509297',
	'4343405610959669',
	'4343405617319438',
	'4343405610660838',
	'4343405619533317',
	'4343405613147460',
	'4343405614104965',
	'4343405612542588',
	'4343405619893778',
	'4343405613579373',
	'4343405614586260',
	'4343405612261197',
	'4343405612666445',
	'4343405619050783',
	'4343405614273026',
	'4343405610438698',
	'4343405614526761',
	'4343405614324381',
	'4343405610489600',
	'4343405618076227',
	'4343405612059344',
	'4343405613761039',
	'4343405611744045',
	'4343405613298008',
	'4343405616846928',
	'4343405616803275',
	'4343405612046275',
	'4343405618505118',
	'4343405614018801',
	'4343405613266609',
	'4343405619122202',
	'4343405619533473',
	'4343405612926278',
	'4343405611077099',
	'4343405610453861',
	'4343405611118729',
	'4343405618672827',
	'4343405616501903',
	'4343405611240531',
	'4343405619935603',
	'4343405618240856',
	'4343405617442966',
	'4343405614375326',
	'4343405612991496',
	'4343405615250569',
	'4343405619387060',
	'4343405612918184',
	'4343405614947595',
	'4343405617732317',
	'4343405615990750',
	'4343405611179481',
	'4343405616226949',
	'4343405618176027',
	'4343405614513710',
	'4343405611998914',
	'4343405611959387',
	'4343405612509181',
	'4343405614141587',
	'4343405619793200',
	'4343405619362378',
	'4343405612667260',
	'4343405617952402',
	'4343405616362488',
	'4343405616595855',
	'4343405615205860',
	'4343405617699128',
	'4343405615431177',
	'4343405619937922',
	'4343405619901753',
	'4343405616504428',
	'4343405616299094',
	'4343405613649796',
	'4343405616813886',
	'4343405612131507',
	'4343405612076397',
	'4343405618360787',
	'4343405611147140',
	'4343405611352161',
	'4343405616678685',
	'4343405617412571',
	'4343405617773774',
	'4343405615510954',
	'4343405615095865',
	'4343405610237389',
	'4343405618808116',
	'4343405610491440',
	'4343405611701532',
	'4343405613137685',
	'4343405619889768',
	'4343405618845514',
	'4343405610839655',
	'4343405613800589',
	'4343405610306861',
	'4343405618915556',
	'4343405616953898',
	'4343405619611261',
	'4343405612110436',
	'4343405614472156',
	'4343405613458628',
	'4343405614908571',
	'4343405611181792',
	'4343405616808290',
	'4343405616618152',
	'4343405616257704',
	'4343405612329051',
	'4343405617506315',
	'4343405614270824',
	'4343405612012681',
	'4343405616541214',
	'4343405618737034',
	'4343405618571623',
	'4343405615259107',
	'4343405611215731',
	'4343405616642731',
	'4343405613873123',
	'4343405613316974',
	'4343405613924090',
	'4343405617630990',
	'4343405613256410',
	'4343405613449759',
	'4343405612642628',
	'4343405615546487',
	'4343405617922389',
	'4343405618033129',
	'4343405610305988',
	'4343405612545771',
	'4343405611617316',
	'4343405618838022',
	'4343405612845478',
	'4343405617966154',
	'4343405613292795',
	'4343405614466679',
	'4343405616952411',
	'4343405614084134',
	'4343405612430636',
	'4343405610417148',
	'4343405613571206',
	'4343405617499172',
	'4343405612015973',
	'4343405614136264',
	'4343405618727001',
	'4343405614182144',
	'4343405614611472',
	'4343405614234705',
	'4343405619978579',
	'4343405611562777',
	'4343405611906867',
	'4343405617795892',
	'4343405615857009',
	'4343405619322422',
	'4343405619177990',
	'4343405617044614',
	'4343405613807170',
	'4343405619705527',
	'4343405614021516',
	'4343405618629413',
	'4343405615945689',
	'4343405615851937',
	'4343405611562918',
	'4343405616560669',
	'4343405612025121',
	'4343405619719692',
	'4343405614379922',
	'4343405611525899',
	'4343405615695961',
	'4343405615792198',
	'4343405612564913',
	'4343405612063452',
	'4343405610288085',
	'4343405611977173',
	'4343405611173732',
	'4343405612875517',
	'4343405619111684',
	'4343405612600774',
	'4343405616637509',
	'4343405615896213',
	'4343405616137526',
	'4343405614677002',
	'4343405610838590',
	'4343405614763075',
	'4343405617773089',
	'4343405614378379',
	'4343405619638637',
	'4343405614219334',
	'43434056142295010',
	'4343405613478485',
	'4343405618480387',
	'4343405610583386',
	'4343405618507171',
	'4343405610301938',
	'4343405612500354',
	'4343405617148928',
	'4343405611555185',
	'4343405618793094',
	'4343405615855177',
	'4343405614141413',
	'4343405611144824',
	'4343405619605768',
	'4343405612601491',
	'4343405610401456',
	'4343405611321794',
	'4343405618329543',
	'4343405612392935',
	'4343405614014750',
	'4343405612954502',
	'4343405617968226',
	'4343405616578158',
	'4343405613712883',
	'4343405619651960',
	'4343405610185885',
	'4343405618100811',
	'4343405610495284',
	'4343405617403372',
	'4343405616129648',
	'4343405615163432',
	'4343405612786797',
	'4343405614023306',
	'4343405615578043',
	'4343405613523017',
	'4343405612727601',
	'4343405610665019',
	'4343405613009538',
	'4343405610386913',
	'4343405617991889',
	'4343405611497339',
	'4343405610693045',
	'4343405616842356',
	'4343405610386152',
	'4343405616666961',
	'4343405614560356',
	'4343405615547147',
	'4343405619762205',
	'4343405619155640',
	'4343405616632880',
	'4343405612004688',
	'4343405610179011',
	'4343405617838890',
	'4343405615707154',
	'4343405613982395',
	'4343405611237875',
	'4343405615632865',
	'4343405613141034',
	'4343405610974775',
	'4343405616331566',
	'4343405613971448',
	'4343405614908969',
	'434340561239',
	'4343405614791639',
	'4343405615591715',
	'4343405610332362',
	'4343405612160985',
	'4343405616382445',
	'4343405614222742',
	'4343405610542085',
	'4343405613691038',
	'4343405617509699',
	'4343405610151820',
	'4343405617279574',
	'4343405616080510',
	'4343405618780588',
	'4343405610355066',
	'4343405611666404',
	'4343405619171944',
	'4343405610757717',
	'4343405613028215',
	'4343405610415787',
	'4343405617123947',
	'4343405612820984',
	'4343405616610779',
	'4343405613079606',
	'4343405619266629',
	'4343405613798874',
	'4343405610394214',
	'4343405617228035',
	'4343405612210335',
	'4343405614500675',
	'4343405610090994',
	'4343405614106366',
	'4343405615508537',
	'4343405611493957',
	'4343405619773590',
	'4343405614912078',
	'4343405613365955',
	'4343405616796172',
	'4343405619778334',
	'4343405619672339',
	'4343405610194754',
	'4343405618936735',
	'4343405613668432',
	'4343405610668716',
	'4343405611716134',
	'4343405614004512',
	'4343405619377343',
	'4343405610962937',
	'4343405618894173',
	'4343405618697840',
	'4343405615324349',
	'4343405619094526',
	'4343405610072786',
	'4343405614713179',
	'4343405612206465',
	'4343405614691342',
	'4343405617942106',
	'4343405613349256',
	'43434056102295014',
	'4343405613728772',
	'4343405613024396',
	'4343405615615811',
	'4343405616719075',
	'4343405610763335',
	'4343405610704859',
	'4343405616747530',
	'4343405613320968',
	'4343405613271062',
	'4343405610385733',
	'4343405612167717',
	'4343405614777810',
	'4343405613168359',
	'4343405611594853',
	'4343405619171852',
	'4343405617398440',
	'4343405615904942',
	'4343405618246572',
	'4343405617678478',
	'4343405615302147',
	'4343405615102018',
	'4343405613927416',
	'4343405619336406',
	'4343405614038882',
	'4343405618038599',
	'4343405611343962',
	'4343405616814520',
	'4343405614697026',
	'4343405613967743',
	'4343405614100005',
	'4343405615428363',
	'4343405618010291',
	'4343405611259044',
	'4343405619663395',
	'4343405614791506',
	'4343405613456176',
	'4343405613099059',
	'4343405619217796',
	'4343405610284811',
	'4343405618714363',
	'4343405618894124',
	'4343405618776099',
	'4343405611286682',
	'4343405618156755',
	'4343405612222017',
	'4343405610957275',
	'4343405611522912',
	'4343405615348389',
	'4343405617355358',
	'4343405613728194',
	'4343405619537334',
	'4343405611013185',
	'4343405617208607',
	'4343405612692656',
	'4343405615761920',
	'4343405619734204',
	'4343405617163000',
	'4343405610873308',
	'4343405614889813',
	'4343405618705460',
	'4343405619662645',
	'4343405616390075',
	'4343405611015388',
	'4343405616697982',
	'4343405615723664',
	'4343405619727695',
	'4343405615952347',
	'4343405617211650',
	'4343405612923796',
	'4343405619581027',
	'4343405612493410',
	'4343405615832150',
	'4343405611159772',
	'4343405618731870',
	'4343405615757472',
	'4343405611918011',
	'4343405610926361',
	'4343405614007275',
	'4343405612925452',
	'4343405616568613',
	'4343405618843022',
	'4343405618568603',
	'4343405612344878',
	'4343405616998414',
	'4343405614010089',
	'4343405610394842',
	'4343405616766746',
	'4343405617200760',
	'4343405615567384',
	'4343405618555352',
	'4343405613966174',
	'4343405619186736',
	'4343405611868646',
	'4343405614427531',
	'4343405618035835',
	'4343405619698383',
	'4343405616417159',
	'4343405610714437',
	'4343405615357612',
	'4343405619273310',
	'4343405613666014',
	'4343405618086499',
	'4343405614017530',
	'4343405611004036',
	'4343405615173597',
	'4343405617081913',
	'4343405617422364',
	'4343405610975996',
	'4343405613881878',
	'4343405612529999',
	'4343405617000087',
	'4343405610195090',
	'4343405619082182',
	'4343405619938151',
	'4343405616269162',
	'4343405614079027',
	'4343405617511083',
	'4343405619302366',
	'4343405616585203',
	'4343405616373592',
	'4343405610968215',
	'4343405613170850',
	'4343405616920210',
	'4343405610321969',
	'4343405617905186',
	'4343405619511016',
	'4343405614896776',
	'4343405611119974',
	'4343405617237382',
	'4343405613174951',
	'4343405611349597',
	'4343405613067270',
	'4343405615744314',
	'4343405617560213',
	'4343405616727730',
	'4343405619582769',
	'4343405615640264',
	'4343405619153546',
	'4343405612779008',
	'4343405614470507',
	'4343405615236212',
	'4343405611195149',
	'4343405618152572',
	'4343405619889669',
	'4343405610712852',
	'4343405614023876',
	'4343405615289831',
	'4343405619292401',
	'4343405611415125',
	'4343405619595670',
	'4343405616806344',
	'4343405616145669',
	'4343405610346636',
	'4343405614634458',
	'4343405613976231',
	'4343405615670667',
	'4343405617355408',
	'4343405612388990',
	'4343405616219100',
	'4343405616197421',
	'4343405613505469',
	'4343405615233789',
	'4343405617383749',
	'4343405617511869',
	'4343405610830670',
	'4343405615728440',
	'4343405610069394',
	'4343405611660001',
	'4343405612238708',
	'4343405619435984',
	'4343405617744',
	'4343405610491762',
	'4343405615624466',
	'4343405612416379',
	'4343405617719561',
	'4343405613617710',
	'4343405616290994',
	'4343405616067756',
	'4343405617049753',
	'4343405614506789',
	'4343405619249203',
	'4343405618603806',
	'4343405619073207',
	'4343405612497999',
	'4343405616088463',
	'4343405611738286',
	'4343405614018785',
	'4343405616424296',
	'4343405617780969',
	'4343405613587632',
	'4343405618895691',
	'4343405617095822',
	'4343405616032172',
	'4343405612911882',
	'4343405612780113',
	'4343405619884793',
	'4343405612833623',
	'4343405616845821',
	'4343405618283005',
	'4343405617347108',
	'4343405615921151',
	'4343405612281914',
	'4343405616882899',
	'4343405616894217',
	'4343405619640526',
	'4343405619700361',
	'4343405615268694',
	'4343405613449429',
	'4343405611596726',
	'4343405614987682',
	'4343405612626985',
	'4343405619605594',
	'4343405614159654',
	'4343405612858372',
	'4343405612841493',
	'4343405617716336',
	'4343405618627144',
	'4343405615320404',
	'4343405612668466',
	'4343407006367812',
	'4343405612545839',
	'4343405615590618',
	'4343405610744350',
	'43434056176647715',
	'4343405611825604',
	'4343405611811349',
	'4343405619770539',
	'4343405613885630',
	'4343405616661574',
	'4343407003651143',
	'4343407006521830',
	'4343405618235989',
	'43434056176744',
	'4343405619127466',
	'4343405613908275',
	'4343405617053714',
	'4343405619784993',
	'4343405619114290',
	'4343405615358198',
	'4343405619102220',
	'4343405619693038',
	'43434056105495007',
	'4343405619753089',
	'4343405614046927',
	'4343405616681168',
	'4343405616660683',
	'4343405614687779',
	'4343405613443620',
	'4343405614565017',
	'4343405617772735',
	'4343405616417662',
	'4343405613340990',
	'4343405619340820',
	'4343405614021995',
	'4343407006832773',
	'4343407008901303',
	'4343407006670017',
	'4343407005800813',
	'4343407009144051',
	'4343407008018959',
	'4343407006114164',
	'4343407000649744',
	'4343407009911400',
	'4343407000980552',
	'4343407004113135',
	'4343407001424774',
	'4343407005636894',
	'4343407001501647',
	'4343407008104965',
	'4343407001688733',
	'4343407003714222',
	'4343407008816774',
	'4343407000128129',
	'4343407003293946',
	'4343407008055662',
	'4343407003713877',
	'4343407005823369',
	'4343407009096764',
	'4343407009987558',
	'4343407008202462',
	'4343407007005494',
	'4343407007781763',
	'4343407005976696',
	'4343407008824463',
	'4343407005457895',
	'4343407008293982',
	'4343407002052269',
	'4343407000957139',
	'4343407004205667',
	'4343407009013124',
	'4343407009265336',
	'4343407007689354',
	'4343407002688955',
	'4343407003808503',
	'4343407002180995',
	'4343407002245517',
	'4343407004406356',
	'4343407005372847',
	'4343407007561389',
	'4343407005687186',
	'4343407002609423',
	'4343407003473803',
	'4343407007790343',
	'4343407000702188',
	'4343407002215783',
	'4343407008309739',
	'4343407003607368',
	'4343407001745426',
	'4343407006856020',
	'4343407003546467',
	'4343407001361125',
	'4343407000796750',
	'4343407002765191',
	'4343407005487322',
	'4343407006188978',
	'4343407008996329',
	'4343407009099412',
	'4343407002971732',
	'4343407001126924',
	'4343407000307442',
	'4343407003289837',
	'4343407008509379',
	'4343407003644015',
	'4343407007975761',
	'4343407008885753',
	'4343407004923228',
	'4343407006630284',
	'4343407004036302',
	'4343407000927744',
	'4343407005365304',
	'4343407002869258',
	'4343407007176113',
	'4343407001279525',
	'4343407008466125',
	'4343407000038781',
	'4343407007951895',
	'4343407005781070',
	'4343407009097549',
	'4343407001599591',
	'4343407008543832',
	'4343407000460688',
	'4343407009881454',
	'4343407009153854',
	'4343407001462121',
	'4343407007783280',
	'4343407009595716',
	'4343407002760390',
	'4343407007957157',
	'4343407006165505',
	'4343407006653013',
	'4343407006519834',
	'4343407000817036',
	'4343407000620760',
	'4343407005254482',
	'4343407001284285',
	'4343407005427229',
	'4343407005645929',
	'4343407004904459',
	'4343407006478213',
	'4343407009337986',
	'4343407000873914',
	'4343407008025392',
	'4343407009006706',
	'4343407003652646',
	'4343407005976753',
	'4343407003074502',
	'4343407000821343',
	'4343407004370396',
	'4343407007084978',
	'4343407007124253',
	'4343407009268389',
	'4343407000347679',
	'4343407009045258',
	'4343407006463132',
	'4343407009988002',
	'4343407004252008',
	'4343407004477159',
	'4343407007974996',
	'4343407007886703',
	'4343407006588391',
	'4343407007361426',
	'4343407002191273',
	'4343407000176664',
	'4343407003593212',
	'4343407003388738',
	'4343407005272476',
	'4343407005455329',
	'4343407005181164',
	'4343407008926623',
	'4343407002232275',
	'4343407009649422',
	'4343407005928721',
	'4343407004805037',
	'4343407008226826',
	'4343407004383803',
	'4343407008123528',
	'4343407006153121',
	'4343407002161888',
	'4343407004419540',
	'4343407001978449',
	'4343407001535256',
	'4343407008101797',
	'4343407001935647',
	'4343407008817343',
	'4343407003481830',
	'4343407005512970',
	'4343407007155042',
	'4343407001771372',
	'4343407005017947',
	'4343407008152857',
	'4343407005873695',
	'4343407007648699',
	'4343407006158310',
	'4343407008558723',
	'4343407001066146',
	'4343407006272293',
	'4343407003414575',
	'4343407003052839',
	'4343407005922039',
	'4343407004841669',
	'4343407004271784',
	'4343407009527537',
	'4343407002252877',
	'4343407006963180',
	'4343407000549027',
	'4343407006493626',
	'4343407001530323',
	'4343407008323706',
	'4343407000029137',
	'4343407001335640',
	'4343407007991883',
	'4343407008872264',
	'4343407003434094',
	'4343407001192264',
	'4343407007872927',
	'4343407004491747',
	'4343407009295655',
	'4343407003336075',
	'4343407009858387',
	'4343407002710197',
	'4343407006608058',
	'4343407007100121',
	'4343407006721315',
	'4343407006620855',
	'4343407007054815',
	'4343407002880768',
	'4343407004780370',
	'4343407007497311',
	'4343407005065409',
	'4343407005388223',
	'4343407006563931',
	'4343407009596417',
	'4343407001495857',
	'4343407006600485',
	'4343407006779008',
	'4343407002802044',
	'4343407001625909',
	'4343407001599534',
	'4343407001122717',
	'4343407006358118',
	'4343407003478182',
	'4343407003462988',
	'4343407001653414',
	'4343407006882992',
	'4343407008318987',
	'4343407007200210',
	'4343407003437774',
	'4343407000510714',
	'4343407009311056',
	'4343407005830893',
	'4343407006078872',
	'4343407002177561',
	'4343407006329689',
	'4343407004573072',
	'4343407000763917',
	'4343407004676230',
	'4343407005319939',
	'4343407002630536',
	'4343407004437179',
	'4343407004742545',
	'4343407002538424',
	'4343407005559583',
	'4343407007298511',
	'4343407004076951',
	'4343407007498749',
	'4343407000042585',
	'4343407008149903',
	'4343407005288845',
	'4343407003189623',
	'4343407000114848',
	'4343407005234120',
	'4343407003497190',
	'4343407004736224',
	'4343407004546235',
	'4343407000589544',
	'4343407003698847',
	'4343407000482443',
	'4343407007509552',
	'4343407004483165',
	'4343407003753121',
	'4343407009011896',
	'4343407000728621',
	'4343407006069954',
	'4343407001113385',
	'4343407007975753',
	'4343407004798422',
	'4343407007686657',
	'4343407002597362',
	'4343407000791298',
	'4343407002164221',
	'4343407002851090',
	'4343407005660183',
	'4343407008881869',
	'4343407005912964',
	'4343407000746722',
	'4343407004442484',
	'4343407003669897',
	'4343407008715638',
	'4343407007829125',
	'4343407004857814',
	'4343407006431576',
	'4343407005797332',
	'4343407008759867',
	'4343407008046141',
	'4343407004851759',
	'4343407002935596',
	'4343407007003606',
	'4343407000513858',
	'4343407007752590',
	'4343407003767022',
	'4343407008878949',
	'4343407001755276',
	'4343407007089498',
	'4343407007111169',
	'4343407005710491',
	'434340700946'
];

/**
 * @type {{ Name: string, Account: string, "Payment Date": string, Status: string, "Net Customer Payment": string, "Payment Method": string, "Payment Type": string }[]}
 */
let pnm_report_arr = pnm_report_filepath
	? csvToArray(Fs.readFileSync(pnm_report_filepath).toString())
	: [];

const asyncMain = async () => {
	const total = str_arr.length;
	for (let [index, cardNumber] of str_arr.entries()) {
		console.log(
			`Looking for card number ${cardNumber} (${index + 1} of ${total})...`
		);

		if (cardNumber.length !== 16) {
			console.log(`Card Number length is not 16. Skipping.`);
			continue;
		}

		let grep_command = `grep "${cardNumber}" ${all_time_log_path}`;
		/** @type {string} */
		let grep_result = await execute(grep_command);

		/**
		 * It's reversed so we go from latest to earliest.
		 */
		let grep_arr = grep_result
			? grep_result
					.split('\n')
					.reverse()
					.map(r => {
						try {
							return JSON.parse(r);
						} catch (err) {
							return {};
						}
					})
			: [];

		// Find Order ID and, if found, look it up in PNM Report.
		let pnm_elem;
		let grep_item_with_order_id = grep_arr.find(grep => !!grep.orderId);
		if (grep_item_with_order_id) {
			pnm_elem = pnm_report_arr.find(
				pnm => pnm.Account === grep_item_with_order_id.orderId
			);
		}

		if (pnm_elem) {
			console.log(
				`It was successfully paid on ${pnm_elem['Payment Date']}; that's why it doesn't show anymore. Found in PNM Report.`
			);
			continue;
		}

		/** @type {string} */
		const last_run_id = grep_arr.find(g => !!g.runId)?.runId;

		if (!last_run_id) {
			console.log(`Card Number not found. Skipping.`);
			continue;
		}

		grep_command = `grep "${last_run_id}" ${all_time_log_path}`;
		/** @type {string} */
		grep_result = await execute(grep_command);

		grep_arr = grep_result
			? grep_result.split('\n').map(r => {
					try {
						return JSON.parse(r);
					} catch (err) {
						return {};
					}
				})
			: [];

		const successful_log = grep_arr.find(log => {
			return log.msg === 'Response from payOnLandingPagePnm' && !!log.isSuccess;
		});

		if (successful_log) {
			const date = new Date(successful_log.time).toISOString();
			console.log(
				`It was successfuly paid on ${date}; that's why it doesn't show anymore.`
			);
		} else {
			console.log(`It was not successfuly paid. Should look into it.`);
		}
	}
};

asyncMain()
	.then(() => console.log('Finished'))
	.catch(err => console.error(err))
	.finally(() => process.exit());
